# Микросервис для визуализации данных

Этот микросервис предназначен для обработки загрузки данных, их хранения и визуализации данных об землетрясениях. Пользователи могут загружать данные об землетрясениях непосредственно и микросервис сохранит данные на диске и информацию о них в базе данных. Пользователю будет предложено предоставить необходимую информацию, такую как дата и тип данных, связанных с загружаемыми данными.

## Установка
- Скопируйте репозиторий\
```git clone https://github.com/Yuri-ga1/Earthquake_summer_practice.git```
- Создайте окружение\
```conda create -n eq python=3.11```
- Активируйте окружение\
```conda activate eq```
- Перейдите в папку с проектом\
```cd */Earthquake_summer_practice```
- Установите необходимые библиотеки\
```conda install cartopy h5py scipy```
- Установите poetry\
```pip install poetry```
- Установите зависимости\
```poetry install```
- Запустите проект\
```python start.py```
- Введите в адресную строку\
```127.0.0.1:8083/docs```

## Конечные точки (Endpoints)

### 1. Создание пользователя

- **Endpoint:** `POST /users/`
- **Модель запроса:** `UserIn`
- **Модель ответа:** `UserOut`
- **Описание:** Создает нового пользователя и сохраняет его информацию в базе данных. Пользователь идентифицируется по электронной почте.

### 2. Загрузка файлов

- **Endpoint:** `POST /upload_files`
- **Параметры запроса:**
  - `email`: Электронная почта пользователя (параметр пути)
  - `date_eq_start`: Дата начала данных о сейсмической активности
  - `date_eq_end`: Дата окончания данных о сейсмической активности
  - `file`: Файл с данными об землетрясении, который требуется загрузить (multipart/form-data)
- **Описание:** Позволяет пользователям загружать файлы с данными об землетрясении. Данные могут быть загружены непосредственно. Данные и связанная информация (дата, тип) будут сохранены на диске и в базе данных.

### 3. Получение файлов по дате

- **Endpoint:** `GET /get_files/{email}/{date}`
- **Параметры запроса:**
  - `email`: Электронная почта пользователя (параметр пути)
  - `date`: Дата, для которой запрашиваются данные (параметр пути)
- **Описание:** Извлекает данные об землетрясении для определенного пользователя и даты из базы данных.

### 4. Получение последней загрузки

- **Endpoint:** `GET /get_last_upload/{email}`
- **Параметры запроса:** `email`: Электронная почта пользователя (параметр пути)
- **Описание:** Получает самую последнюю загрузку данных об землетрясении для определенного пользователя.

### 5. Создание графика

- **Endpoint:** `POST /create_plot/`


- **Параметры запроса:**
  - `email`: Электронная почта пользователя (multipart/form-data)
  - `plot_info`: Информация о графике (модель `Plot`)
- **Описание:** Создает график на основе данных об землетрясении и предоставляет его пользователю. График сохраняется и возвращается пользователю в виде изображения.

### 6. Создание графика расстояния-времени

- **Endpoint:** `POST /create_plot_distance_time/`
- **Параметры запроса:**
  - `email`: Электронная почта пользователя (multipart/form-data)
  - `plot_info`: Информация о графике расстояния-времени (модель `PlotDT`)
- **Описание:** Создает график расстояния-времени на основе данных об землетрясении и предоставляет его пользователю. График сохраняется и возвращается пользователю в виде изображения.

### 7. Создание графика для одного спутника
-**Endpoint:** `POST /create_plot_single_sat/`
- **Параметры запроса:**
  - `email`: Электронная почта пользователя (multipart/form-data)
  - `plot_info`: Информация о графике для одного спутника (модель `PlotSS`)
- **Описание:** Создает график расстояния-времени для одного спутника на основе данных о землетрясении и предоставляет его пользователю в виде изображения. График сохраняется и возвращается пользователю в формате PNG.


### 8. Создание графика для нескольких станций

- **Endpoint:** `POST /create_plot_sites/`
- **Параметры запроса:**
  - `email`: Электронная почта пользователя (multipart/form-data)
  - `plot_info`: Информация о графике для нескольких станций (модель `PlotS`)
- **Описание:** Создает график расстояния-времени для нескольких станций на основе данных о землетрясении и предоставляет его пользователю в виде изображения. График сохраняется и возвращается пользователю в формате PNG.

### 9. Создание графика для всех спутников

- **Endpoint:** `POST /create_plot_all_sats/`
- **Параметры запроса:**
  - `email`: Электронная почта пользователя (multipart/form-data)
  - `plot_info`: Информация о графике для всех спутников (модель `PlotAS`)
- **Описание:** Создает график расстояния-времени для всех спутников на основе данных о землетрясении и предоставляет его пользователю в виде изображения. График сохраняется и возвращается пользователю в формате PNG.

### 10. Получение результатов

- **Endpoint:** `GET /results/{email}`
- **Параметры запроса:** `email`: Электронная почта пользователя (параметр пути)
- **Описание:** Извлекает результаты графиков, созданных пользователем, из базы данных.

## Дополнительная информация

- Микросервис использует фреймворк FastAPI для создания API-точек.
- Для хранения информации о пользователях, загруженных файлах и результатов графиков используется база данных.
- Важные события и ошибки записываются в файл `app.log`, а информационные сообщения выводятся в консоль.


